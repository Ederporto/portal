{% extends 'experiments/base.html' %}

{% block header %}
    {% include 'experiments/header_home.html' %}
{% endblock %}

{% block content %}
    <section class="container">
        {% if messages %}
            {% include 'experiments/messages.html' %}
        {% endif %}

        <h3>Search Results</h3>
        {% if query %}
            <table id="search_experiments_table" class="table table-hover
        experiment-table">
                <thead>
                <tr>
                    <th>Title</th>
                    <th>Description</th>
                    <th>Participants</th>
                    <th>Version</th>
                    <th></th>
                </tr>
                </thead>
                <tbody>
                {% for result in page.object_list %}
                    {% load highlight %}
                    {% if result.model_name == 'experiment' %}
                        <tr>
                            <td>{% highlight result.object.title with query %}</td>
                            <td>
                                {% highlight result.object.description with query %}</td>
                            <td>
                                {{ result.object.total_participants }} in
                                {{ result.object.groups.count }} groups </td>
                            <td>{{ result.object.version }}</td>
                            <td><a href="{% url 'experiment-detail' result.object.id %}">View</a></td>
                        </tr>
                    {% endif %}
                    {% if result.model_name == 'study' %}
                        <tr>
                            <td>{{ result.object.experiment.title }}</td>
                            <td>{{ result.object.experiment.description }}</td>
                            <td>
                                {{ result.object.experiment.total_participants }} in {{ result.object.experiment.groups.count }} groups </td>
                            <td>{{ result.object.experiment.version }}</td>
                            <td><a href="{% url 'experiment-detail' result.object.experiment.id %}">View</a></td>
                        </tr>
                        <tr class="matches-not-experiment">
                        <td colspan="5">
                            <strong>Study:</strong>
                            <p>
                                <strong>title: </strong>
                                {% highlight result.object.title with query %}&nbsp;
                                <strong>description: </strong>
                                {% highlight result.object.description with query %}&nbsp;
                                <strong>start date: </strong>
                                {% highlight result.object.start_date with query %}&nbsp;
                                <strong>end date: </strong>
                                {% highlight result.object.end_date with query %}<br>
                            </p>
                        </td>
                        </tr>
                    {% endif %}
                {% empty %}
                    <p>No results found.</p>
                {% endfor %}
                </tbody>
            </table>

            {% if page.has_previous or page.has_next %}
                <div>
                    {% if page.has_previous %}<a href="?q={{ query }}&amp;page={{ page.previous_page_number }}">{% endif %}&laquo; Previous{% if page.has_previous %}</a>{% endif %}
                    |
                    {% if page.has_next %}<a href="?q={{ query }}&amp;page={{ page.next_page_number }}">{% endif %}Next &raquo;{% if page.has_next %}</a>{% endif %}
                </div>
            {% endif %}
        {% else %}
            <p>There was no results found to the give search terms</p>
             Show some example queries to run, maybe query syntax, something else?
        {% endif %}


    </section>
{% endblock %}